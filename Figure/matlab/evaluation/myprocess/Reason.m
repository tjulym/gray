clc
clear
load data_reason;  
data=data_reason;
%% 1
% set(gcf,'position',[200 200 500 400])
set(gcf,'position',[200 200 600 450])

fontsizebox=8;
% fontsize=12;
% fontsize1=14;
fontsize=12;
fontsize1=14;
legendsize=10;
lineWidth=1;

% ha = tight_subplot(4,1,[.034 .008],[.1 .0170],[.1 .03]) % 图片之间[上下间距,左右间距] 画布[下,上间距] 画布[左,右间距]
% ha = tight_subplot(4,1,[.034 .008],[.14 .0170],[.1 .03]) % 图片之间[上下间距,左右间距] 画布[下,上间距] 画布[左,右间距]
ha = tight_subplot(4,1,[.05 .008],[.14 .013],[.1 .03]) % 图片之间[上下间距,左右间距] 画布[下,上间距] 画布[左,右间距]

%% LSTM
axes(ha(1))
plot(data(:,1),'lineWidth',lineWidth,'Color',[238 41 47]/255);

hold on
% plot(data(:,1),'lineWidth',lineWidth);
plot([109:1:length(data)],data(109:length(data),2),'lineWidth',lineWidth,'Color',[35 31 32]/255);
% hold on
% plot([1048:1:length(data)],data(1048:length(data),3),'lineWidth',lineWidth,'Color',[126 47 142]/255);

hold on; 
plot([91 91],[0 1],'--k','lineWidth',0.5);
hold on; 
plot([109 109],[0 1],'--k','lineWidth',0.5);
hold on; 
plot([136 136],[0 1],'--k','lineWidth',0.5);
hold on; 
plot([223 223],[0 1],'--k','lineWidth',0.5);
hold on; 
plot([320 320],[0 1],'--k','lineWidth',0.5);
hold on; 
plot([481 481],[0 1],'--k','lineWidth',0.5);
hold on
plot([988 988],[0 1],'--k','lineWidth',0.5);
hold on; 
plot([1048 1048],[0 1],'--k','lineWidth',0.5);
plot([1149 1149],[0 1],'--k','lineWidth',0.5);
plot([1800 1800],[0 1],'--k','lineWidth',0.5);
hold on

% 
set(ha(1),'XLim',[0 length(data)])
set(ha(1),'Xtick',[])

set(ha(1),'YLim',[0.6 1]);%X轴的数据显示范围
set(ha(1),'YTick',[0.6:0.2:1],'Fontsize',fontsize);%设置要显示坐标刻度
grid on
ylabel('Workload','Fontsize' ,fontsize1);
set(ha(1),'ycolor',[0 0 0]);
% l1=legend('SN','EC','FO') 
l1=legend('SN','EC') 
% set(l1,'Fontsize',8,'Orientation','horizon');
set(l1,...
    'Position',[0.732222224283553 0.945416667821507 0.233333331445853 0.0524999987334013],...
    'Orientation','horizontal',...
    'FontSize',legendsize);
%%
axes(ha(2)) 
plot(data(:,4),'lineWidth',lineWidth,'Color',[238 41 47]/255);
hold on
plot(data(:,5),'lineWidth',lineWidth,'Color',[35 31 32]/255);
hold on
% plot(data(:,6),'lineWidth',lineWidth,'Color',[126 47 142]/255);
% hold on
% plot(data(:,12),'lineWidth',lineWidth,'Color',[123 124 127]/255);
plot(data(:,12),'lineWidth',lineWidth,'Color',[126 47 142]/255);

hold on
plot([91 91],[0 100],'--k','lineWidth',0.5);
hold on
plot([109 109],[0 100],'--k','lineWidth',0.5);
hold on 
plot([136 136],[0 100],'--k','lineWidth',0.5);
hold on 
plot([223 223],[0 100],'--k','lineWidth',0.5);
hold on 
plot([320 320],[0 100],'--k','lineWidth',0.5);
hold on 
plot([481 481],[0 100],'--k','lineWidth',0.5);
hold on
plot([988 988],[0 100],'--k','lineWidth',0.5);
hold on
plot([1048 1048],[0 100],'--k','lineWidth',0.5);
hold on
plot([1149 1149],[0 100],'--k','lineWidth',0.5);
hold on

set(ha(2),'XLim',[0 length(data)])
set(ha(2),'xtick',[])

set(ha(2),'YLim',[0 100]);%X轴的数据显示范围
set(ha(2),'YTick',[1 2 8 32 100],'Fontsize',fontsize,'YScale','log');%设置要显示坐标刻度
grid on

% l2=legend('SN','EC','FO','BEs') 
l2=legend('SN','EC','SCs/BGs') 
% set(l2,'Fontsize',8,'Orientation','horizon');
set(l2,...
    'Position',[0.5547222261462 0.755416667821507 0.40999999538064 0.0524999987334013],...
    'Orientation','horizontal',...
    'FontSize',legendsize);
ylabel('# Inst.','Fontsize' ,fontsize1);
set(ha(2),'ycolor',[0 0 0]);

%% EMA
axes(ha(3)) 
plot(data(:,7),'MarkerSize',0.5,'Marker','.','LineStyle','-','Color',[238 41 47]/255);
hold on
data(:,8)=data(:,8)/1.5+35;
plot(data(:,8),'MarkerSize',0.5,'Marker','.','LineStyle','-','Color',[0.49 0.18 0.56]);

hold on
plot([1 1920],[267 267],'LineStyle','--','Color',[0 0 0]/255,'lineWidth',1);
hold on
plot([1 1920],[88 88],'LineStyle','--','Color',[0 0 0]/255,'lineWidth',1);
% hold on
% plot([1 1920],[37 37],'LineStyle','-','Color',[126 47 142]/255);

% hold on
% plot(data(:,9),'MarkerSize',0.5,'Marker','.','LineStyle','none','Color',[126 47 142]/255);


plot([91 91],[0 1000],'--k','lineWidth',0.5);
hold on
plot([109 109],[0 1000],'--k','lineWidth',0.5);
hold on 
plot([136 136],[0 1000],'--k','lineWidth',0.5);
hold on 
plot([223 223],[0 1000],'--k','lineWidth',0.5);
hold on 
plot([320 320],[0 1000],'--k','lineWidth',0.5);
hold on 
plot([481 481],[0 1000],'--k','lineWidth',0.5);
hold on
plot([988 988],[0 1000],'--k','lineWidth',0.5);
hold on
plot([1048 1048],[0 1000],'--k','lineWidth',0.5);
hold on
plot([1149 1149],[0 1000],'--k','lineWidth',0.5);
hold on

% l3=legend('SN-SLA','EC-SLA','FO-SLA') 
l3=legend('SN','EC') 
% set(l3,'Fontsize',8,'Orientation','horizon');
set(l3,...
    'Position',[0.632222227561807 0.525416667821507 0.333333328465621 0.0524999987334013],...
    'Orientation','horizontal',...
    'FontSize',legendsize);
set(ha(3),'XLim',[0 length(data)])
set(ha(3),'xtick',[])

set(ha(3),'YLim',[10 1000]);%X轴的数据显示范围
set(ha(3),'YTick',[1 100 1000],'Fontsize',fontsize,'YScale','log');%设置要显示坐标刻度
grid on
ylabel('Latency(ms)','Fontsize' ,fontsize1)
set(ha(3),'ycolor',[0 0 0]);
% %% EMA
% axes(ha(4)) 
% plot(data(:,10),'lineWidth',lineWidth); 
% 
% set(ha(4),'xtick',[])
% set(ha(4),'XLim',[0 length(data)])
% set(ha(4),'YLim',[0 .75]);%X轴的数据显示范围
% set(ha(4),'YTick',[0:.25:.75],'Fontsize',fontsize);%设置要显示坐标刻度 
% set(ha(4),'YTickLabel',[0:.25:.75]*100,'Fontsize',fontsize);%设置要显示坐标刻度
%  
% ylabel('CPU Util.');
% set(ha(4),'ycolor',[0 0 0]); 
% grid on
% l4=legend('CPU Utilization (%)') 
% set(l4,'Fontsize',8,'Orientation','horizon');
% set(ha(4),'ycolor',[0 0 0]);
% %% 
% axes(ha(5)) 
% plot(data(:,11),'lineWidth',lineWidth); 
% 
% set(ha(5),'xtick',[0 :480:1920])
% set(ha(5),'XLim',[0 length(data)])
% set(ha(5),'YLim',[0 .75]);%X轴的数据显示范围
% set(ha(5),'YTick',[0:.25:.75],'Fontsize',fontsize);%设置要显示坐标刻度
% set(ha(5),'YTickLabel',[0:.25:.75]*100,'Fontsize',fontsize);%设置要显示坐标刻度
%  
% ylabel('Mem Util. (%)');
%  
% xlabel('Time (s)');
% set(ha(5),'ycolor',[0 0 0]); 
% set(ha(5),'xcolor',[0 0 0]); 
% grid on
% l5=legend('Memory Utilization (%)') 
% set(l5,'Fontsize',8,'Orientation','horizon');

%%
axes(ha(4)) 
plot(data(:,10),'lineWidth',lineWidth,'Color',[238 41 47]/255); 
hold on
plot(data(:,11),'lineWidth',lineWidth,'Color',[35 31 32]/255); 

hold on
plot([91 91],[0 1],'--k','lineWidth',0.5);
hold on
plot([109 109],[0 1],'--k','lineWidth',0.5);
hold on 
plot([136 136],[0 1],'--k','lineWidth',0.5);
hold on 
plot([223 223],[0 1],'--k','lineWidth',0.5);
hold on 
plot([320 320],[0 1],'--k','lineWidth',0.5);
hold on 
plot([481 481],[0 1],'--k','lineWidth',0.5);
hold on 
plot([988 988],[0 1],'--k','lineWidth',0.5);
hold on
plot([1048 1048],[0 1],'--k','lineWidth',0.5);
hold on
plot([1149 1149],[0 1],'--k','lineWidth',0.5);
plot([1800 1800],[0 1],'--k','lineWidth',0.5);
hold on

% set(ha(4),'xtick',[0 :480:1920])
set(ha(4),'xtick',[0 91 109 136 223 320 481 988 1048 1149 1800])
set(ha(4),'xticklabels',{'0','91','', '136','223' ,'320','481', '988', '1048', '1149', '1800'});
set(gca,'XTickLabelRotation',90) 
% set(ha(4),'xticklabels',{'0','1.5','1.8', '2.26','3.7' ,'5.3', '16.4', '17.4','30'});
set(ha(4),'XLim',[0 length(data)])
set(ha(4),'YLim',[0 1]);%X轴的数据显示范围
set(ha(4),'YTick',[0:.25:1],'Fontsize',fontsize);%设置要显示坐标刻度
set(ha(4),'YTickLabel',[0:.25:1]*100,'Fontsize',fontsize);%设置要显示坐标刻度
 
ylabel('Util.(%)','Fontsize' ,fontsize1);
 
xlabel('Timeline (s)','Fontsize' ,fontsize1);
set(ha(4),'ycolor',[0 0 0]); 
set(ha(4),'xcolor',[0 0 0]); 
grid on
l4=legend('CPU','Memory') 
% set(l4,'Fontsize',8,'Orientation','horizon');
% set(l4,...
%     'Position',[0.610555558635129 0.289166667709748 0.27333333025376 0.0449999989569187],...
%     'Orientation','horizontal',...
%     'FontSize',8);
set(l4,...
    'Position',[0.665555559032496 0.317916667821507 0.299999996125698 0.0524999987334013],...
    'Orientation','horizontal',...
    'FontSize',legendsize);

figure1=gcf

% 创建 textbox
annotation(figure1,'textbox',...
    [0.305000000000003 0.707754677754678 0.0189583333333305 0.0237453222453234],...
    'String','RNN',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.846666666666672 0.680753638253638 0.0254166666666613 0.020746361746363],...
    'String','ALU-in',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.543333333333338 0.680530145530146 0.020729166666662 0.0220093555093566],...
    'String','CNN',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.12 0.679293139293139 0.015416666666667 0.0207068607068609],'String','FG',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.353333333333336 0.678794178794179 0.013854166666664 0.0227058212058223],...
    'String','DD',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 arrow
annotation(figure1,'arrow',[0.376666666666667 0.376666666666669],...
    [0.6675 0.610000000000001],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.571666666666667 0.572604166666672],...
    [0.6625 0.580816008316011],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.753333333333334 0.754270833333343],...
    [0.665 0.580816008316011],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 textbox
annotation(figure1,'textbox',...
    [0.605000000000001 0.725 0.0200000000000081 0.039000000000001],...
    'String','IP',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 arrow
annotation(figure1,'arrow',[0.143229166666667 0.143333333333334],...
    [0.659043659043659 0.5825],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.16 0.160000000000001],[0.6975 0.61],...
    'Color',[0.5 0.5 0.5],...
    'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.2 0.200000000000001],[0.6975 0.61],...
    'Color',[0.5 0.5 0.5],...
    'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.331666666666667 0.331666666666669],...
    [0.7 0.612500000000001],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.301666666666667 0.301666666666669],...
    [0.66 0.607500000000001],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.4015625 0.40166666666667],...
    [0.700623700623701 0.610000000000001],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.4234375 0.423333333333337],...
    [0.66008316008316 0.610000000000001],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.51 0.510000000000005],...
    [0.665 0.610000000000001],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 textbox
annotation(figure1,'textbox',...
    [0.48385416666667 0.679412681912682 0.0176041666666639 0.0220873180873188],...
    'String','json',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.678333333333337 0.680951143451144 0.0292708333333302 0.0205488565488579],...
    'String','Sum-cha',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.243333333333335 0.681491683991684 0.0293749999999983 0.020008316008317],...
    'String','ALU-seq',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.221666666666668 0.711491683991684 0.0123958333333323 0.020008316008316],...
    'String','VP',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.136666666666667 0.709412681912682 0.0122916666666663 0.0230873180873185],...
    'String','FG',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.171666666666668 0.711491683991684 0.0158333333333316 0.0200083160083172],...
    'String','MM',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.746666666666676 0.740452182952183 0.0128124999999913 0.0210478170478181],...
    'String','DA',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 arrow
annotation(figure1,'arrow',[0.77 0.77093750000001],[0.73 0.670816008316011],...
    'Color',[0.5 0.5 0.5],...
    'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.48 0.480000000000005],...
    [0.6975 0.585000000000001],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.883333333333333 0.884270833333347],...
    [0.6625 0.583316008316011],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 textbox
annotation(figure1,'textbox',...
    [0.395000000000003 0.679412681912682 0.021249999999997 0.0220873180873192],...
    'String','iperf3',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.423333333333336 0.713030145530146 0.0296874999999978 0.0209698544698557],...
    'String','Sum-nes',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.513333333333339 0.712952182952183 0.0168749999999959 0.0210478170478186],...
    'String','ALU',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.38166666666667 0.710873180873181 0.0162499999999967 0.0206268191268202],...
    'String','MT',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 arrow
annotation(figure1,'arrow',[0.24375 0.243333333333335],...
    [0.696465696465697 0.611039501039502],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.621354166666667 0.622604166666673],...
    [0.724532224532225 0.656855509355512],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 textbox
annotation(figure1,'textbox',...
    [0.551666666666674 0.712952182952183 0.0268749999999928 0.0210478170478179],...
    'String','ALU-par',...
    'FontSize',8,...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% 创建 arrow
annotation(figure1,'arrow',[0.545833333333333 0.545937500000005],...
    [0.694807692307692 0.621855509355511],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.5984375 0.599270833333339],...
    [0.697926195426195 0.613316008316011],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadLength',5,...
    'HeadStyle','deltoid');

% 创建 arrow
annotation(figure1,'arrow',[0.545833333333333 0.545937500000005],...
    [0.694807692307692 0.621855509355511],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadStyle','deltoid',...
    'HeadLength',5);

% 创建 arrow
annotation(figure1,'arrow',[0.5984375 0.599270833333339],...
    [0.697926195426195 0.613316008316011],'Color',[0.5 0.5 0.5],'HeadWidth',2,...
    'HeadStyle','deltoid',...
    'HeadLength',5);

% 创建 textbox
annotation(figure1,'textbox',...
    [0.314333333333334 0.413333333333333 0.000666666666666593 0.00444444444444436],...
    'String','SLA=88ms',...
    'FitBoxToText','off');

% 创建 textbox
annotation(figure1,'textbox',...
    [0.296 0.537777777777778 0.000666666666666593 0.00444444444444447],...
    'String','SLA=256ms',...
    'FitBoxToText','off');

% 创建 arrow
annotation(figure1,'arrow',[0.436666666666667 0.463333333333333],[0.4 0.44]);

% 创建 arrow
annotation(figure1,'arrow',[0.431666666666667 0.46],...
    [0.513333333333333 0.491111111111111]);